---
layout: distill
title: 'AI810 Blog Post (20243313)'
date: 2025-05-30 11:12:00-0400
description: '1'
authors:
  - name: Byoungwoo Park
    affiliations: 
      name: KAIST
bibliography: blogs.bib
comments: true
hidden: false
---

<d-contents>

  <nav class="l-text figcaption">
  <h3>Contents</h3>
    <div><a href="#introduction"> Introduction </a></div>
    <div><a href="#infinite-dimensional SDEs">Infinite-dimensional SDEs</a></div>
    <div><a href="#infinite-dimensional Diffusion Models">Infinite-dimensional Diffusion Models</a></div>
    <div><a href="#infinite-Dimensional Molecule Conformal Generation">Infinite-Dimensional Molecule Conformal Generation</a></div>
    <div><a href="#concluding-remarks">Concluding remarks</a></div>      
  </nav>
</d-contents>

## Introduction

**Why Introduce Generative Modeling in Function Space?**

Traditional generative models typically represent data as finite-dimensional vectors, such as pixels for images or Cartesian coordinates for molecular conformations. While effective for certain tasks, this discrete representation inherently constrains the models' flexibility, resolution, and generalizability. For example, images are typically generated at fixed resolutions, limiting their use at arbitrary scales. Similarly, molecules represented explicitly by atomic coordinates suffer from limited resolution and sensitivity to permutation and alignment, complicating applications in molecular simulations and drug design.

<div class='l-body'>
<img class="img-fluid rounded z-depth-1" src="{{ site.baseurl }}/assets/img/blog/2dregressiondiagram.png">
<figcaption style="text-align: center; margin-top: 10px; margin-bottom: 10px;"> Image as function <d-cite key="garnelo2018neural"></d-cite>. </figcaption>
</div>

Generative modeling in \emph{function space} addresses these intrinsic limitations by treating data as infinite-dimensional functions rather than fixed-dimensional vectors. Specifically, data instances—such as images<d-cite key="sitzmann2020implicit, dupont2021coin,lim2023scorebased, park2024stochastic"></d-cite>, time-series<d-cite key="bilovs2023modeling, park2024stochastic"></d-cite>, or molecular conformations<d-cite key="wang2024swallowing"></d-cite>—can be conceptualized as continuous functions mapping input coordinates (spatial or structural) into output spaces (such as colors for images or three-dimensional positions for molecules). Formally, an image can be represented as a function $$f:\mathbb{R}^2\rightarrow\mathbb{R}^3$$, mapping any location in two-dimensional space directly to RGB values. Analogously, a molecular structure can be treated as a function that maps vertices of a molecular graph into spatial coordinates, i.e., $$f:V(G)\rightarrow\mathbb{R}^3$$.

This functional representation provides several compelling advantages:

* **Resolution invariance:** A single trained model can generate outputs at arbitrary resolutions, overcoming the limitation of discrete grid-based methods.
* **Permutation invariance and continuity:** By inherently encoding permutation invariance, function space models avoid explicit symmetrization procedures, which can be computationally expensive or impractical for large datasets, especially in molecular contexts.
* **Natural interpolation and extrapolation:** Functional representations facilitate straightforward interpolation and extrapolation within the generative model's learned function space, enhancing the generalizability of generated outputs.
* **Robustness to sampling strategies:** Since functions can be evaluated continuously, generative models are robust to various sampling schemes, enabling efficient and flexible deployment in diverse settings.

The adoption of function space modeling, especially in complex domains such as molecular generation, has been facilitated by recent advances in machine learning frameworks adept at managing infinite-dimensional inputs and outputs, including neural operators, Gaussian processes, and diffusion processes. In this post, we discuss how the infinite-dimensional framework can be extended specifically for molecular generation, and we outline the key challenges involved in this adaptation.


## Infinite-dimensional SDEs


In traditional finite-dimensional settings, a stochastic differential equation (SDE) in $$\mathbb{R}^d$$ is typically expressed as:
$$
\begin{equation}
dX_t = f(t,X_t)\,dt + \sigma(t,X_t)\,dW_t,
\end{equation}
$$

where $$W_t$$ is a standard Wiener process. Extending this formulation to infinite-dimensional spaces involves defining SDEs in Hilbert spaces<d-cite key="da2014stochastic"></d-cite>
:

$$
\begin{equation}
dX_t = AX_t\,dt + \sigma\,dW_t^Q,\quad X_0 \in H,
\end{equation}
$$

where:
* $$H$$ is an infinite-dimensional Hilbert space,
* $$A : H \to H$$ is typically an unbounded linear operator,
* $$W_t^Q$$ is a $$Q$$-Wiener process, a generalization of the finite-dimensional Wiener process with covariance operator $Q$ reflecting spatial correlations inherent in infinite-dimensional spaces.


Specifically, a $Q$-Wiener process can be expanded via an eigenbasis of the Hilbert space $$H$$:

$$
\begin{equation}
W_t^Q = \sum_{k=1}^{\infty} Q^{1/2}\phi_k\, w_t^{(k)},
\end{equation}
$$

where $$\{\phi_k\}$$ forms an orthonormal basis of $$H$$ and $$w_t^{(k)}$$ are independent scalar Wiener processes. The covariance operator $$Q$$ determines spatial correlation and smoothness properties of the stochastic process. Unlike finite-dimensional spaces where identity covariance operators suffice, in infinite-dimensional spaces, the identity operator is typically not trace-class, necessitating a carefully chosen covariance operator $Q$ to ensure mathematical and physical relevance.

**Role of $$Q$$:** 
The covariance operator $Q$ plays a crucial theoretical role in infinite-dimensional SDEs by ensuring the stochastic increments have finite trace and appropriately reflect spatial correlations. It defines the regularity and correlation structure of the infinite-dimensional noise, making $Q$ essential for well-posedness and tractability of the SDE in infinite-dimensional spaces.


To numerically simulate infinite-dimensional SDEs, particularly those driven by negative Laplacian operators $$-\Delta$$, one often employs spectral decompositions.
Specifically, for a two-dimensional domain $$x = (x_1, x_2) \in \mathbb{R}^2$$, eigenfunctions $$\phi^{(k)}(x)$$ and eigenvalues $$\lambda^{(k)}$$ of $$-\Delta$$ under zero Neumann boundary conditions satisfy:


$$
\begin{equation}
  -\Delta \phi^{(k)}(\mathbf{x}) = \lambda^{(k)} \phi^{(k)}(\mathbf{x}), \quad \frac{\partial \phi^{(k)}(\mathbf{x})}{\partial x_1} = \frac{\partial \phi^{(k)}(\mathbf{x})}{\partial x_2} = 0.
\end{equation}
$$

On a rectangular domain, these eigenfunctions form a separable cosine basis:

$$
\begin{equation}
    \phi^{(n, m)}(x_1, x_2) \sim \cos{\left(\frac{\pi n x_1}{W}\right)}\cos{\left(\frac{\pi m x_2}{H}\right)}, \quad \lambda^{(n, m)} = \pi^2 \left(\frac{n^2}{W^2} + \frac{m^2}{H^2} \right).
\end{equation}
$$

Thus, the negative Laplacian operator $$-\Delta$$ can be represented via eigen-decomposition:


$$
\begin{equation} 
  -\Delta = E D E^{\top}
\end{equation}
$$

where $$E^{\top}$$ corresponds to the discrete cosine transform (DCT) projection matrix, i.e., $$\tilde{X}_t = E^{\top} X_t = \text{DCT}(X_t)$$, and $D$ is diagonal containing eigenvalues. The covariance matrix $Q$ crucially characterizes the spatial correlation and numerical stability in simulations.



## Infinite-dimensional Diffusion Models

<div class='l-body'>
<img class="img-fluid rounded z-depth-1" src="{{ site.baseurl }}/assets/img/blog/super_res_mnist.png">
<figcaption style="text-align: center; margin-top: 10px; margin-bottom: 10px;"> Generated Image (function) <d-cite key="franzese2024continuous"></d-cite>. </figcaption>
</div>

Many classical finite-dimensional diffusion models can naturally and successfully be extended into infinite-dimensional or function spaces<d-cite key="pidstrigach2023infinite,lim2023score,hagemann2023multilevel,lim2023scorebased, franzese2024continuous, baldassari2024conditional"></d-cite>
. These infinite-dimensional diffusion models leverage the theoretical framework of infinite-dimensional SDEs, enabling direct modeling of distributions on functional data (e.g., images, molecular structures, and continuous time-series). This extension provides resolution invariance, enhanced flexibility, and robust generative capabilities beyond traditional finite-dimensional frameworks.


While standard diffusion models typically generate data by transforming Gaussian noise through a learned score or drift function, a natural generalization arises when we consider generating data conditioned on data---leading to the framework of Schrödinger Bridge problems<d-cite key="Pra1991ASC"></d-cite>. In this formulation, one seeks a diffusion process that connects two data distributions (e.g., source and target) while remaining close to a reference process in KL divergence. This generalization has led to recent developments in data-to-data generative models<d-cite key="chen2022likelihood, shi2024diffusion"></d-cite>, and crucially, when it meets the infinite-dimensional generalization, it enables resolution-free unpaired generation across diverse modalities<d-cite key="park2024stochastic"></d-cite>.


<div class="row l-body">
	<div class="col-sm">
	  <img class="img-fluid rounded z-depth-1" src="{{ site.baseurl }}/assets/img/publication_preview/cat2wild_64.gif">
   <figcaption style="text-align: center; margin-top: 10px; margin-bottom: 10px;"> Results on Unpaired image transfer task. </figcaption>
	</div>
	<div class="col-sm">
  <img class="img-fluid rounded z-depth-1" src="{{ site.baseurl }}/assets/img/publication_preview/cat2wild_128.gif">
   <figcaption style="text-align: center; margin-top: 10px; margin-bottom: 10px">Red boxed images were upsampled (using bi-linear transformation) from
the observed resolution. </figcaption>
  </div>
</div>


## Infinite-Dimensional Molecule Conformal Generation


<d-cite key="wang2024swallowing"></d-cite>




<div class="row l-body">
	<div class="col-sm">
	  <img class="img-fluid rounded z-depth-1" src="{{ site.baseurl }}/assets/img/blog/traj_drugs.gif">
   <figcaption style="text-align: center; margin-top: 10px; margin-bottom: 10px;"> Drug generation Traj<d-cite key="wang2024swallowing"></d-cite>
. </figcaption>
	</div>
	<div class="col-sm">
  <img class="img-fluid rounded z-depth-1" src="{{ site.baseurl }}/assets/img/blog/traj_xl.gif">
   <figcaption style="text-align: center; margin-top: 10px; margin-bottom: 10px">Drug generation Traj<d-cite key="wang2024swallowing"></d-cite>
. </figcaption>
  </div>
</div>





## Concluding remarks

